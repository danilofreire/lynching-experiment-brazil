---
title: |
       | Supplementary Material for "Vigilantism and Institutions: Understanding Attitudes toward Lynching in Brazil"
author: 
  - Danilo Freire[^danilo]
  - David Skarbek[^david]
date: \today
fontfamily: libertine
fontawesome: yes
fontsize: 12pt
monospace-url: yes
spacing: double
papersize: a4paper
bibliography: ../article/references.bib
biblio-style: apalike
output:
  pdf_document:
    citation_package: natbib
    fig_caption: yes
    number_sections: yes
    highlight: haddock
    toc: true
    toc_depth: 3
    keep_tex: no
    template: template.latex
---

\newpage

[^danilo]: School of Social and Political Sciences, University of Lincoln,
<dfreire@lincoln.ac.uk>, <https://danilofreire.github.io>.

[^david]: Department of Political Science, Brown University,
<david_skarbek@brown.edu>, <http://davidskarbek.com>.

\appendix

# Introduction

This appendix contains the `R` code required to replicate the results we present
in "_Vigilantism and Institutions: Understanding Attitudes towards Lynching in
Brazil_". This file also includes the descriptive statistics of our sample, the
average marginal component effects (AMCEs) for our conjoint experiment, and
additional subgroup analyses for the two experiments included in the main
article.

The code below loads the required datasets and the `R` packages we use in our
statistical analyses. It also translates the names of the factor variables from
Portuguese into English.

\footnotesize
```{r loading, warning=F, message=F, error=F, cache=T}
# Install and load required packages
packages <- c("bartCause", "cjoint", "cregg", "estimatr", "kableExtra",
              "janitor", "quanteda", "quanteda.textmodels", "quanteda.textplots",
              "quanteda.textstats", "seededlda", "stargazer", "tidyverse")
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
  install.packages(packages[!installed_packages])
}
invisible(lapply(packages, library, character.only = TRUE))

# Load the dataset, remove unused rows and columns,
# and convert variable names to snake case
df <- read_csv("../data/data.csv") %>%
  clean_names() %>%
  mutate(response_id            = as.character(response_id),
         consent                = as.factor(q1),
         progress               = as.numeric(progress),
         finished               = as.factor(finished),
         age                    = as.numeric(q2),
         gender                 = as.factor(q3),
         race                   = as.factor(q4),
         education              = as.factor(q5),
         region                 = as.factor(q6),
         household_income       = as.factor(q7),
         ideology               = as.factor(q8),
         death_penalty          = as.factor(q9),
         previous_victim        = as.character(q10),
         previous_victim_text   = as.character(q10_text),
         views_police           = as.factor(q11),
         views_justice          = as.factor(q12),
         exp01_control          = as.numeric(q18),
         exp01_police           = as.numeric(q19),
         exp01_slow_justice     = as.numeric(q20),
         exp01_small_punishment = as.numeric(q21),
         exp03_control          = as.numeric(q22),
         exp03_constitution     = as.numeric(q23),
         exp03_rights           = as.numeric(q24),
         exp03_vendetta         = as.numeric(q25)) %>%
  slice(-1L) %>%
  select(-c(q1:q12, q18:q25)) %>%
  relocate(response_id, consent, progress, finished,
           location_latitude, location_longitude) %>%
  mutate(across(where(is.character), tolower)) %>%
  mutate(across(where(is.factor), tolower))

# Translate factor values from Portuguese to English
df <- df %>%
  mutate(consent = recode(consent,
                          concordo       = "Agree",
                          `não concordo` = "Disagree"),
         gender = recode(gender,
                         "feminino"              = "Female",
                         "masculino"             = "Male",
                         "outro"                 = "Other",
                         "prefiro não responder" = "Rather Not Say"),
         race = recode(race,
                       "amarela"               = "Asian",
                       "branca"                = "White",
                       "indígena"              = "Indigenous",
                       "outra"                 = "Other",
                       "parda"                 = "Mixed Race",
                       "prefiro não responder" = "Rather Not Say",
                       "preta"                 = "Black"),
         race = fct_relevel(race, "Other", "Rather Not Say", after = Inf),
         education = recode(education,
                            "da 1ª à 4ª série do ensino fundamental (antigo primário)" = "Primary School",
                            "da 5ª à 8ª série do ensino fundamental (antigo ginásio)"  = "Secondary School",
                            "ensino médio (antigo 2º grau)"                            = "High School",
                            "ensino superior"                                          = "College",
                            "mestrado ou doutorado"                                    = "Graduate School",
                            "não sei"                                                  = "Don't Know"),
         education = fct_relevel(education, "Primary School", "Secondary School", "High School",
                                 "College", "Graduate School", "Don't Know"),
         region = recode(region,
                         "centro-oeste" = "Center-West",
                         "nordeste"     = "Northeast",
                         "norte"        = "North",
                         "sudeste"      = "Southeast",
                         "sul"          = "South"),
         household_income = recode(household_income,
                                   "acima de r$ 20.000"       = "Above R$20,000",
                                   "até r$ 1.000"             = "Up to R$1,000",
                                   "de r$ 1.001 a r$ 2.000"   = "From R$1,001 to R$2,000",
                                   "de r$ 10.000 a r$ 20.000" = "From R$10,001 to R$20,000",
                                   "de r$ 2.001 a r$ 3.000"   = "From R$2,001 to R$3,000",
                                   "de r$ 3.001 a r$ 5.000"   = "From R$3,001 to R$5,000",
                                   "de r$ 5.001 a r$ 10.000"  = "From R$5,001 to R$10,000"),
         household_income = fct_relevel(household_income,
                                        "Up to R$1,000",
                                        "From R$1,001 to R$2,000", "From R$2,001 to R$3,000",
                                        "From R$3,001 to R$5,000", "From R$5,001 to R$10,000",
                                        "From R$10,001 to R$20,000", "Above R$20,000"),
         ideology = recode(ideology,
                           "centro"                = "Center",
                           "centro-direita"        = "Center-Right",
                           "centro-esquerda"       = "Center-Left",
                           "direita"               = "Right",
                           "esquerda"              = "Left",
                           "não sei"               = "Don't Know",
                           "prefiro não responder" = "Rather Not Say"),
         ideology = fct_relevel(ideology, "Left", "Center-Left", "Center",
                                "Center-Right", "Right", "Don't Know",
                                "Rather Not Say"),
         death_penalty = recode(death_penalty,
                                "não"                   = "No",
                                "não sei"               = "Don't Know",
                                "prefiro não responder" = "Rather Not Say",
                                "sim"                   = "Yes"),
         death_penalty = fct_relevel(death_penalty, "Don't Know",
                                     "Rather Not Say", after = Inf),
         views_police = recode(views_police,
                               "boa"                   = "Good",
                               "muito boa"             = "Very Good",
                               "muito ruim"            = "Very Bad",
                               "não sei"               = "Don't Know",
                               "prefiro não responder" = "Rather Not Say",
                               "regular"               = "Regular",
                               "ruim"                  = "Bad"),
         views_police = fct_relevel(views_police, "Very Good", "Good", "Regular",
                                    "Bad", "Very Bad", "Don't Know", "Rather Not Say"),
         views_justice = recode(views_justice,
                                "boa"                   = "Good",
                                "muito boa"             = "Very Good",
                                "muito ruim"            = "Very Bad",
                                "não sei"               = "Don't Know",
                                "prefiro não responder" = "Rather Not Say",
                                "regular"               = "Regular",
                                "ruim"                  = "Bad"),
         views_justice = fct_relevel(views_justice, "Very Good", "Good", "Regular",
                                    "Bad", "Very Bad", "Don't Know", "Rather Not Say"),
         previous_victim_dummy = recode(previous_victim,
                                        "nenhum" = "No",
                                        .missing = NA_character_,
                                        .default = "Yes")) %>%
  relocate(response_id:previous_victim, previous_victim_dummy,
           previous_victim_text:f_5_2_8)

# Check for duplicated values
count(get_dupes(df))
```
\normalsize

# Descriptive Statistics

```{r sample-size, echo=F, warning=F, error=F, message=F, cache=T}
df1 <- df %>% filter(consent == "Agree")
```

We ran our survey experiments from October 30 to December 14, 2020 via
Qualtrics. Our sample includes `r nrow(df1)` Brazilians older than 18 years of
age from the five regions of the country (Center-West, North, Northeast, South,
and Southeast). We used quotas for gender and region to ensure that our sample
was similar to the Brazilian population in those characteristics. We also
collected information about whether the subjects had been victimized in the
previous 12 months, as well as their opinion of the Brazilian judicial system
and the police forces. They follow in the graphs and tables below.

## Informed Consent

About 98% of the interviewees agreed to participate in the survey experiment.
We excluded the remaining 2% from our analyses.

\footnotesize
```{r consent, warning=F, error=F, cache=T}
df %>%
  group_by(consent) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 2)) %>%
  rename(Consent = consent) %>%
  kbl(., booktabs = TRUE, caption = "Informed Consent") %>%
  row_spec(0, bold = TRUE) %>%
  kable_styling(latex_options = "hold_position")

# Remove subjects who did not agree with consent form
df1 <- df %>% filter(consent == "Agree")
```
\normalsize

## Gender

The gender distribution of our sample is described below. It closely matches
the official data from the [Brazilian Census
Bureau](https://educa.ibge.gov.br/jovens/conheca-o-brasil/populacao/18320-quantidade-de-homens-e-mulheres.html),
which states that women are 51.8% of the population and men comprise 48.2%.

\footnotesize
```{r gender, warning=F, error=F, cache=T}
df1 %>%
  group_by(gender) %>%
  filter(!is.na(gender)) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 3)) %>%
  rename(Gender = gender) %>%
  kbl(., booktabs = TRUE, caption = "Gender") %>%
  row_spec(0, bold = TRUE) %>%
  kable_styling(latex_options = "hold_position")
```
\normalsize

## Age

The age distribution of our sample is shown below. The median age of the survey
respondents is `r round(median(df1$age, na.rm=T), 1)` years old, which indicates
that our sample is older than the Brazilian population (median age $= 33.4$
years old).

\footnotesize
```{r age, warning=F, error=F, cache=T, fig.width=6, fig.height=4.3}
tibble(` `    = "Age",
       Median = round(median(df1$age, na.rm = TRUE), 2),
       Mean   = round(mean(df1$age, na.rm = TRUE), 2),
       SD     = round(sd(df1$age, na.rm = TRUE), 2),
       Min    = min(df1$age, na.rm = TRUE),
       Max    = max(df1$age, na.rm = TRUE),
       `NA`   = sum(is.na(df1$age))) %>%
kbl(., booktabs = TRUE, caption = "Age") %>%
row_spec(0, bold = TRUE) %>%
kable_styling(latex_options = "hold_position")

ggplot(subset(df1, !is.na(age)), aes(age)) +
  geom_bar(fill = "#152238") +
  labs(title = "Age Distribution", x = "Age", y = "Count") +
  geom_vline(aes(xintercept = mean(age, na.rm = TRUE)),
            color = "darkred", linetype = 5, size = 0.5) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))
```
\normalsize

## Race

The next demographic variable we show here is race. According to the [Brazilian
Census
Bureau](https://educa.ibge.gov.br/jovens/conheca-o-brasil/populacao/18319-cor-ou-raca.html),
42.7% of the Brazilian population identify as White, 46.8% as Mixed Race, 9.4%
as Blacks, and 1.1% as Asians or Indigenous. As we see below, our sample
includes more Whites and fewer Mixed-Race individuals. The number of Blacks
roughly coincide with their actual population share.

\footnotesize
```{r race, warning=F, error=F, cache=T}
df1 %>%
  rename(Race = race) %>%
  mutate(Race = fct_relevel(Race, "White", "Other", "Rather Not Say", after = Inf)) %>%
  group_by(Race) %>%
  filter(!is.na(Race)) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 3)) %>%
  kbl(., booktabs = TRUE,  linesep = "", caption = "Race") %>%
  row_spec(0, bold = TRUE) %>%
  kable_styling(latex_options = "hold_position")
```
\normalsize

## Education

```{r educationtext, echo=F, warning=F, error=F, cache=T}
df2 <- df1 %>%
  group_by(education) %>%
  filter(!is.na(education)) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 3)) %>%
  rename(Education = education)
```

As expected, our sample is also more educated than [the Brazilian
population](https://educa.ibge.gov.br/jovens/conheca-o-brasil/populacao/18317-educacao.html).
About `r df2[4, 3]*100`% of the respondents have a college degree, and `r df2[3, 3]*100`%
have graduate school education.

\footnotesize
```{r education, warning=F, error=F, cache=T}
df1 %>%
  rename(Education = education) %>%
  mutate(Education = fct_relevel(Education, "Primary School", "Secondary School",
                                 "High School", "College", "Graduate School")) %>%
  group_by(Education) %>%
  filter(!is.na(Education)) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 3)) %>%
  kbl(., booktabs = TRUE,  linesep = "", caption = "Education") %>%
  row_spec(0, bold = TRUE) %>%
  kable_styling(latex_options = "hold_position")
```
\normalsize

## Household Income

```{r income-text, echo=F, warning=F, error=F, cache=T}
df2 <- df1 %>%
  group_by(household_income) %>%
  filter(!is.na(household_income)) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 3)) %>%
  rename(`Household Income` = household_income)
```

In terms of household income, `r df2[5, 3]*100`% of the respondents earn from
R\$5,0001 to R\$10,000 per month (US\$915 to US\$1830 as of January 2021), which
comprise the largest group in our sample. However, the sample also contains
`r df2[2, 3]*100`% of participants whose household income ranges between R\$1,001
and R\$2,000 (US\$ 184 to US\$368) and `r df2[1, 3]*100`% with household incomes
up to R\$1,000, which is roughly equivalent to Brazil's monthly minimum wage. In
this respect, we have reached participants from all social classes.

\footnotesize
```{r income, warning=F, error=F, cache=T}
df1 %>%
  rename(`Household Income` = household_income) %>%
  mutate(`Household Income` = fct_relevel(`Household Income`, "Up to R$1,000",
                                          "From R$1,001 to R$2,000", "From R$2,001 to R$3,000",
                                          "From R$3,001 to R$5,000", "From R$5,001 to R$10,000",
                                          "From R$10,001 to R$20,000", "Above R$20,000")) %>%
  group_by(`Household Income`) %>%
  filter(!is.na(`Household Income`)) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 3)) %>%
  kbl(., booktabs = TRUE,  linesep = "", caption = "Household Income") %>%
  row_spec(0, bold = TRUE) %>%
  kable_styling(latex_options = "hold_position")
```
\normalsize

## Political Ideology

```{r ideologytext, echo=F, warning=F, error=F, cache=T}
df2 <- df1 %>%
  group_by(ideology) %>%
  filter(!is.na(ideology)) %>%
  mutate(ideology = fct_relevel(ideology, "Left")) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 3)) %>%
  rename(Ideology = ideology)
```

We have also collected information regarding the subjects' political ideology.
Most respondents identify themselves as right-wingers (`r df2[5, 3]*100`%),
followed by left-wingers (`r df2[1, 3]*100`%), and centrists (`r df2[3, 3]*100`%).
Subjects who do not know their ideology or prefer not to tell their
political beliefs are also large in number (`r df2[6, 3]*100`% and
`r df2[7, 3]*100`%, respectively).

\footnotesize
```{r ideology, warning=F, error=F, cache=T}
df1 %>%
  rename(Ideology = ideology) %>%
  mutate(Ideology = fct_relevel(Ideology, "Left", "Center-Left", "Center",
                                "Center-Right", "Right")) %>%
  group_by(Ideology) %>%
  filter(!is.na(Ideology)) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 3)) %>%
  kbl(., booktabs = TRUE,  linesep = "", caption = "Political Ideology") %>%
  row_spec(0, bold = TRUE) %>%
  kable_styling(latex_options = "hold_position")
```
\normalsize

\newpage

## Support for Death Penalty

Below you may find how many respondents support the death penalty.

\footnotesize
```{r death-penalty, warning=F, error=F, cache=T}
df1 %>%
  rename(`Support for Death Penalty` = death_penalty) %>%
  mutate(`Support for Death Penalty` = fct_relevel(`Support for Death Penalty`, "Yes", "No")) %>%
  group_by(`Support for Death Penalty`) %>%
  filter(!is.na(`Support for Death Penalty`)) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 3)) %>%
  kbl(., booktabs = TRUE,  linesep = "", caption = "Support for Death Penalty") %>%
  row_spec(0, bold = TRUE) %>%
  kable_styling(latex_options = "hold_position")
```
\normalsize

## Previous Victimization

We asked subjects whether they had been victimized in the previous 12 months,
as crime victims may be more likely to support lynchings. The responses follow
below.

\footnotesize
```{r victimization, warning=F, error=F, cache=T}
df1 %>%
  rename(Victimization = previous_victim_dummy) %>%
  mutate(Victimization = fct_relevel(Victimization, "Yes", "No")) %>%
  group_by(Victimization) %>%
  filter(!is.na(Victimization)) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 3)) %>%
  kbl(., booktabs = TRUE,  linesep = "", caption = "Previous Victimization (12 Months)") %>%
  row_spec(0, bold = TRUE) %>%
  kable_styling(latex_options = "hold_position")
```
\normalsize

## Opinion on the Police

Here we show the results for our question on how respondents see the police
forces.

\footnotesize
```{r police, warning=F, error=F, cache=T}
df1 %>%
  rename(`Opinion on the Police` = views_police) %>%
  mutate(`Opinion on the Police` = fct_relevel(`Opinion on the Police`, "Very Good", "Good",
                                               "Regular", "Bad", "Very Bad")) %>%
  group_by(`Opinion on the Police`) %>%
  filter(!is.na(`Opinion on the Police`)) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 3)) %>%
  kbl(., booktabs = TRUE,  linesep = "", caption = "Opinion on the Police") %>%
  row_spec(0, bold = TRUE) %>%
  kable_styling(latex_options = "hold_position")
```
\normalsize

\newpage

## Opinion on the Judicial System

Lastly, we asked how respondents evaluate their local judiciary. As in the
previous question, subjects could choose among five options, as well as affirm
that they do not have an opinion or decline to answer the question.

\footnotesize
```{r justice, warning=F, error=F, cache=T}
df1 %>%
  rename(`Opinion on the Justice System` = views_justice) %>%
  mutate(`Opinion on the Justice System` = fct_relevel(`Opinion on the Justice System`, "Very Good",
                                                       "Good", "Regular", "Bad", "Very Bad")) %>%
  group_by(`Opinion on the Justice System`) %>%
  filter(!is.na(`Opinion on the Justice System`)) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 3)) %>%
  kbl(., booktabs = TRUE,  linesep = "", caption = "Opinion on the Justice System") %>%
  row_spec(0, bold = TRUE) %>%
  kable_styling(latex_options = "hold_position")
```
\normalsize

# Experiment 01

## Description

In our first experiment, we present five pairs of criminal profiles to
respondents. Each profile contains eight attributes: 1) gender of the crime
perpetrator; 2) age of the crime perpetrator; 3) race of the crime perpetrator;
4) residency of crime perpetrator; 5) offense; 6) gender of the victim of the
motivating crime; 7) age of the victim of the motivating crime; 8) lynching
perpetrators. The attributes and levels are displayed in table
\ref{tab:categories} below.

\vspace{.3cm}

\begin{table}[htpb]
\small
\begin{center}
\caption{\textbf{Attributes and Levels}}
\label{tab:categories}
\begin{tabular}{l !{\vrule width 1pt}p{9cm}}
\Xhline{2\arrayrulewidth}
\textbf{Attribute} & \multicolumn{1}{c}{\textbf{Levels}} \\
\Xhline{2\arrayrulewidth}
\small
Gender of crime perpetrator & Male; female \\ [4pt]
Age of crime perpetrator & Teenager; adult; elderly \\ [4pt]
Race of crime perpetrator & Black; White; Native Brazilian; Asian \\ [4pt]
Residency of crime perpetrator & Resident in the community; outsider \\ [4pt]
Offense & Picks the pocket; steals the car; molests; rapes; murders \\ [4pt]
Gender of crime victim & Male; female\\ [4pt]
Age of crime victim & Child; teenager; adult; elderly\\ [4pt]
Lynching perpetrators & Bystanders; neighbors; family of the victim; gangs; police \\
\Xhline{2\arrayrulewidth}
\end{tabular}
\end{center}
\end{table}

We added three restrictions to the conjoint design to avoid implausible
scenarios. First, female rapists were excluded from the model, but we did
include female molesters in the conjoint experiment. Second, when the offense
was car theft, the victim could not be a child. Lastly, teenagers could not be
victims of car theft either. All other combinations were allowed. We randomized
the attributes using a `.php` script, which is available at
<https://github.com/danilofreire/lynching-experiment-brazil/blob/master/conjoint/portuguese/lynching-conjoint-pt.php>.

Respondents indicated which profile they preferred for extrajudicial punishment.
Prior to selecting the profiles, respondents were asked to read the following prompt:

* Lynchings are often used as social punishment in Brazil. Lynchings are cases
  in which three or more people physically attack or execute a suspected
  criminal in public. We are interested in knowing more about how Brazilians
  see these episodes. In the next five questions, please read the description
  of two possible lynching victims in Brazil and indicate in which case you
  believe the punishment is more justified. Even if you are not entirely sure,
  please select one of the cases.[^portuguese]

[^portuguese]: Original text in Portuguese: Linchamentos são às vezes usados
como punição social no Brasil. Linchamentos são casos nos quais três ou mais
pessoas agridem fisicamente ou executam em público um suspeito de um crime.
Estamos interessados em saber mais sobre como os brasileiros vêem estes
episódios. Nas próximas cinco questões, por favor, leia a descrição de duas
possíveis vítimas de linchamento no Brasil e indique em quais delas você
acredita que a punição é mais justificada. Mesmo que você não tenha certeza,
por favor, escolha um dos casos.

## Marginal Means Estimator

We estimate the conjoint experiment with the `cregg` package [@leeper2018cregg]
for the `R` statistical language [@rstats2019]. We follow @leeper2020measuring
and report marginal means as our main estimates. Marginal means are easy to
interpret and they are not sensitive to choice of the reference category in
subgroup analyses. The $H_0$ in all models is that the coefficient is equal to
0.5, that is, that respondents are indifferent to that attribute level. Standard
errors are clustered by respondent. The code follows below.

\footnotesize
```{r conjoint-mm, warning=F, error=F, message=F, cache=T, fig.width=7, fig.height=6}
conjoint_data <- read.qualtrics("../data/data-conjoint.csv",
                                responses = c("Q13", "Q14", "Q15",
                                              "Q16", "Q17"),
                                covariates = c("ResponseId",
                                               "Q1", "Q2", "Q3", "Q4",
                                               "Q5", "Q6", "Q7",
                                               "Q8", "Q9", "Q10",
                                               "Q11", "Q12"),
                                new.format = FALSE, respondentID = NULL)

conjoint_data <- conjoint_data %>%
  rename(response_id                      = ResponseId,
         Age                              = Q2,
         Gender                           = Q3,
         Race                             = Q4,
         Education                        = Q5,
         Region                           = Q6,
         "Household Income"               = Q7,
         Ideology                         = Q8,
         "Support death penalty"          = Q9,
         "Previous Victimization"         = Q10,
         "Offense"                        = Crime,
         "Opinion on Policing"            = Q11,
         "Opinion on Judiciary"           = Q12,
         "Gender of crime victim"         = "Gênero.da.vítima",
         "Gender of crime perpetrator"    = "Gênero.do(a).criminoso(a)",
         "Age of crime victim"            = "Idade.da.vítima",
         "Age of crime perpetrator"       = "Idade.do(a).criminoso(a)",
         "Lynching perpetrators"          = "Linchadores",
         "Race of crime perpetrator"      = "Raça.do(a).criminoso(a)",
         "Residency of crime perpetrator" = "Residência.do.criminoso") %>%
  mutate(`Gender of crime perpetrator` = fct_recode(`Gender of crime perpetrator`,
                                                    "Male"   = "Masculino",
                                                    "Female" = "Feminino"),
         `Age of crime perpetrator` = fct_recode(`Age of crime perpetrator`,
                                                 "Teenager" = "Adolescente",
                                                 "Adult"    = "Adulto(a)",
                                                 "Elderly"  = "Idoso(a)"),
         `Race of crime perpetrator` = fct_recode(`Race of crime perpetrator`,
                                                  "Asian"      = "Asiático(a)",
                                                  "White"      = "Branco(a)",
                                                  "Indigenous" = "Indígena",
                                                  "Black"      = "Negro(a)"),
         `Residency of crime perpetrator` = fct_recode(`Residency of crime perpetrator`,
                                                       "Another neighborhood" = "Mora em outro bairro",
                                                       "In the neighborhood"  = "Mora na vizinhança"),
         `Offense` = fct_recode(`Offense`,
                                "Murder"         = "Assassinou",
                                "Pick-pocketing" = "Bateu a carteira",
                                "Rape"           = "Estuprou",
                                "Molestation"    = "Molestou",
                                "Car theft"      = "Roubou o carro"),
         `Gender of crime victim` = fct_recode(`Gender of crime victim`,
                                               " Male"   = "Masculino",
                                               " Female" = "Feminino"),
         `Age of crime victim` = fct_recode(`Age of crime victim`,
                                            " Teenager" = "Adolescente",
                                            " Child"    = "Criança",
                                            " Adult"    = "Adulto(a)",
                                            " Elderly"  = "Idoso(a)"),
         `Lynching perpetrators` = fct_recode(`Lynching perpetrators`,
                                              "Family of the victim" = "Família da vítima",
                                              "Gangs"                = "Gangues",
                                              "Bystanders"           = "Pedestres",
                                              "Police"               = "Polícia",
                                              "Neighbors"            = "Vizinhos")) %>%
  select(-c(16, 18, 20, 22, 24, 26, 28, 30)) %>%
  mutate(response_id = tolower(response_id))

# Model
fm <- selected ~ `Gender of crime perpetrator` +
  `Age of crime perpetrator` + `Race of crime perpetrator` +
  `Residency of crime perpetrator` + `Offense` +
  `Gender of crime victim` + `Age of crime victim` +
  `Lynching perpetrators`

mms <- mm(conjoint_data, fm, id = ~response_id, h0 = 0.5)

# Plot
faces <- c(rep("plain", 5), "bold",
           rep("plain", 4), "bold",
           rep("plain", 2), "bold",
           rep("plain", 5), "bold",
           rep("plain", 2), "bold",
           rep("plain", 4), "bold",
           rep("plain", 3), "bold",
           rep("plain", 2), "bold")

plot(mms, vline = 0.5, header_fmt = "%s") +
  theme(legend.position = "none", axis.text.y = element_text(face = faces, size = 10)) +
  scale_colour_viridis_d(option = "inferno", end = 0.8)

# Table
table_mm <- function(mms, capt) {
dfr <- data.frame(feature = mms[, c(4)],
                  round(mms[, c(5, 6, 8, 9, 10)], digits = 3))
names(dfr) <- c("Feature", "Estimate", "Std. Error",
                "P-Value", "Lower", "Upper")
return(kbl(dfr, "latex", caption = capt, linesep = "",
           booktabs = TRUE) %>%
kable_styling(font_size = 12, full_width = TRUE,
              latex_options = "hold_position") %>%
pack_rows("Gender of crime perpetrator", 1, 2) %>%
pack_rows("Age of crime perpetrator", 3, 5) %>%
pack_rows("Race of crime perpetrator", 6, 9) %>%
pack_rows("Residency of crime perpetrator", 10, 11) %>%
pack_rows("Offense", 12, 16) %>%
pack_rows("Gender of crime victim", 17, 18) %>%
pack_rows("Age of crime victim", 19, 22) %>%
pack_rows("Lynching perpetrators", 23, 27) %>%
column_spec(1, width = "6cm"))
}

table_mm(mms, capt = "Marginal Means -- Full Model")
```
\normalsize

\clearpage

## Average Marginal Component Effect (AMCE) Estimator

We also estimate AMCE coefficients for our conjoint experiment. This method
selects one reference category for each attribute and looks at changes from the
baseline level. The reference categories are marked as zero in our models.

\footnotesize
```{r conjoint-amce, warning=F, error=F, message=F, cache=T, fig.width=7, fig.height=6}
amces <- cj(conjoint_data, fm, id = ~response_id)

plot(amces, vline = 0.0, header_fmt = "%s") +
  theme(legend.position = "none",
        axis.text.y = element_text(face = faces, size = 10)) +
  scale_colour_viridis_d(option = "inferno", end = 0.8)

table_mm(amces, capt = "Average Marginal Component Effects -- Full Model")
```
\normalsize

\clearpage

## Subgroup Analyses

In this subsection, we test whether our results vary according to individual
characteristics, such as gender, age, race, income, support for death penalty,
and the respondents' opinions on the judicial system and the police forces. All
models report marginal means. As we shall see, the results are very robust
across all model specifications.

### Gender

Results do not seem to vary according to the gender of the respondent. We focus
here on the differences between males and females and exclude the 11
observations in which respondents preferred not to say their gender or marked
"other" in our questionnaire. Across all conjoint experiment attributes, we see
an overlap between the 95% confidence intervals for males and females.

\footnotesize
```{r conjoint-females, warning=F, message=F, error=F, cache=T, fig.width=7, fig.height=5.3, fig.pos = "H"}
# Model
cjdt <- full_join(conjoint_data, df1, by = "response_id") %>%
  drop_na(gender) %>%
  filter(gender == c("Male", "Female"))
cjdt$Gender <- factor(cjdt$gender)
mm_by <- cj(cjdt, fm, id = ~response_id, estimate = "mm", h0 = 0.5, by = ~Gender)

# Plot
plot(mm_by, group = "Gender", vline = 0.5, header_fmt = "%s") +
  theme(legend.position = "bottom", axis.text.y = element_text(face = faces, size = 10)) +
  scale_colour_viridis_d(option = "inferno", end = 0.8)

# Tables
table_mm_by <- function(mm_by, capt) {
dfr <- data.frame(feature = mm_by[, c(5)],
                  round(mm_by[, c(6, 7, 9, 10, 11)], digits = 3))
names(dfr) <- c("Feature", "Estimate", "Std. Error",
                "P-Value", "Lower", "Upper")
return(kbl(dfr, "latex", caption = capt, linesep = "",
           booktabs = TRUE) %>%
kable_styling(font_size = 12, full_width = TRUE,
              latex_options = "hold_position") %>%
pack_rows("Gender of crime perpetrator", 1, 2) %>%
pack_rows("Age of crime perpetrator", 3, 5) %>%
pack_rows("Race of crime perpetrator", 6, 9) %>%
pack_rows("Residency of crime perpetrator", 10, 11) %>%
pack_rows("Offense", 12, 16) %>%
pack_rows("Gender of crime victim", 17, 18) %>%
pack_rows("Age of crime victim", 19, 22) %>%
pack_rows("Lynching perpetrators", 23, 27) %>%
column_spec(1, width = "6cm"))
}

mm_females <- mm_by %>% filter(BY == "Female")
table_mm_by(mm_females, capt = "Marginal Means -- Females")
mm_males <- mm_by %>% filter(BY == "Male")
table_mm_by(mm_males, capt = "Marginal Means -- Males")
```
\normalsize

\clearpage

### Age

As our age variable is continuous, we divide the data into three age brackets:
18-34 years old, 35-54 years old, and 55+ years old. The results show that
seniors (55+) are more likely to select profiles that include murder as an
offense, and less inclined to choose cases involving molestation. The remaining
attributes show little variation.

\footnotesize
```{r conjoint-age, warning=F, message=F, error=F, cache=T, fig.width=7, fig.height=5.2, fig.pos="H"}
# Model
cjdt <- full_join(conjoint_data, df1, by = "response_id") %>%
  drop_na(age) %>%
  mutate(age2 = case_when(age >= 18 & age <= 34 ~ "18-34", age >= 35 & age <= 54 ~ "35-54",
                          age >= 55 ~ "55 plus", TRUE ~ as.character(age)))
cjdt$Age <- factor(cjdt$age2)
mm_by <- cj(cjdt, fm, id = ~response_id, estimate = "mm", h0 = 0.5, by = ~Age)

# Plot
plot(mm_by, group = "Age", vline = 0.5, header_fmt = "%s") +
  theme(legend.position = "bottom", axis.text.y = element_text(face = faces, size = 10)) +
  scale_colour_viridis_d(option = "inferno", end = 0.8, begin = 0.25)

# Tables
mm_young <- mm_by %>% filter(BY == "18-34")
table_mm_by(mm_young, capt = "Marginal Means -- 18-34 Years Old")
mm_adult <- mm_by %>% filter(BY == "35-54")
table_mm_by(mm_adult, capt = "Marginal Means -- 35-54 Years Old")
mm_senior <- mm_by %>% filter(BY == "55 plus")
table_mm_by(mm_senior, capt = "Marginal Means -- 55+ Years Old")
```
\normalsize

\clearpage

### Race

Below are our results when we disaggregate the data by race. We find that they are
almost identical is all dimensions except for offense. Asian respondents are
much less likely to select profiles that contain pickpocketing as a crime.

\footnotesize
```{r conjoint-race, warning=F, message=F, error=F, cache=T, fig.width=7, fig.height=5.4, fig.pos="H"}
# Model
cjdt <- full_join(conjoint_data, df1, by = "response_id") %>%
  drop_na(race) %>%
  filter(race == c("Asian", "Black", "Mixed Race", "White"))
cjdt$Race <- factor(cjdt$race)
mm_by <- cj(cjdt, fm, id = ~response_id, estimate = "mm", h0 = 0.5, by = ~Race)

# Plot
plot(mm_by, group = "Race", vline = 0.5, header_fmt = "%s") +
  theme(legend.position = "bottom", axis.text.y = element_text(face = faces, size = 10)) +
  scale_colour_viridis_d(option = "inferno", end = 0.8)

# Tables
mm_asian <- mm_by %>% filter(BY == "Asian")
table_mm_by(mm_asian, capt = "Marginal Means -- Asian")
mm_black <- mm_by %>% filter(BY == "Black")
table_mm_by(mm_black, capt = "Marginal Means -- Black")
mm_mixed <- mm_by %>% filter(BY == "Mixed Race")
table_mm_by(mm_mixed, capt = "Marginal Means -- Mixed Race")
mm_white <- mm_by %>% filter(BY == "White")
table_mm_by(mm_white, capt = "Marginal Means -- White")
```
\normalsize

\clearpage

### Education

Next, we divide our data according to respondents' level of education. As the
number of interviewees with primary or secondary education is low, we merge them
into a single category, while the other levels (high school, college, and
graduate school) remain the same as in our questionnaire. While most results are
similar across all model specifications, we find that respondents with a high
school degree tend to punish Blacks more severely, but participants with a
college degree believe that White criminals should be punished more harshly
instead. The finding deserves attention because it indicates that individuals
with lower levels of education, who are more likely to be Black and Mixed Race
in Brazil, perhaps prefer to punish criminals of own race. The same is true for
Whites, who are usually overrepresented in college education. The differences
are not statistically significant, however, for respondents with university
degrees.

\footnotesize
```{r conjoint-education, warning=F, message=F, error=F, cache=T, fig.width=8, fig.height=6, fig.pos="H"}
# Model
cjdt <- full_join(conjoint_data, df1, by = "response_id") %>%
  drop_na(education) %>%
  filter(education == c("College", "Graduate School",
                        "Primary School", "Secondary School",
                        "High School")) %>%
  mutate(education2 = case_when(education == "Primary School" ~ "Primary or Secondary School",
                                education == "Secondary School" ~ "Primary or Secondary School",
                                TRUE ~ as.character(education)),
         education2 = fct_relevel(education2, "Primary or Secondary School",
                                  "High School", "College", "Graduate School"))
cjdt$Education <- factor(cjdt$education2)
mm_by <- cj(cjdt, fm, id = ~response_id, estimate = "mm", h0 = 0.5, by = ~Education)

# Plot
plot(mm_by, group = "Education", vline = 0.5, header_fmt = "%s") +
  theme(legend.position = "bottom", axis.text.y = element_text(face = faces, size = 10)) +
  scale_colour_viridis_d(option = "inferno", end = 0.8, begin = 0.25)

# Tables
mm_pri_sec <- mm_by %>% filter(BY == "Primary or Secondary School")
table_mm_by(mm_pri_sec, capt = "Marginal Means -- Primary or Secondary School Degree")
mm_high <- mm_by %>% filter(BY == "High School")
table_mm_by(mm_high, capt = "Marginal Means -- High School Degree")
mm_college <- mm_by %>% filter(BY == "College")
table_mm_by(mm_college, capt = "Marginal Means -- College Degree")
mm_grad <- mm_by %>% filter(BY == "Graduate School")
table_mm_by(mm_grad, capt = "Marginal Means -- Graduate School Degree")
```
\normalsize

\clearpage

### Household Income

We also disaggregate the results by monthly household income. As some
categories have few respondents, we group them into three categories: (i) up to
R\$3,000 (US\$550); (ii) from R\$3,001 to R\$5,000 (US\$550-915); and (iii)
above R\$5,000 (US\$915+). The levels roughly represent low, middle, and
high-income households. We find no considerable differences among them, except
the fact that respondents with lower incomes are more likely to select profiles
that include White criminals. 

\footnotesize
```{r conjoint-income, warning=F, message=F, error=F, cache=T, fig.width=8, fig.height=6, fig.pos="H"}
# Model
cjdt <- full_join(conjoint_data, df1, by = "response_id") %>%
  drop_na(household_income) %>%
  mutate(household_income2 = case_when(household_income == "Up to R$1,000" ~ "Up to R$3,000",
                                       household_income == "From R$1,001 to R$2,000" ~ "Up to R$3,000",
                                       household_income == "From R$2,001 to R$3,000" ~ "Up to R$3,000",
                                       household_income == "From R$3,001 to R$5,000" ~ "From R$3,001 to R$5,000",
                                       household_income == "From R$5,001 to R$10,000" ~ "Above R$5,000",
                                       household_income == "From R$10,001 to R$20,000" ~ "Above R$5,000",
                                       household_income == "Above R$20,000" ~ "Above R$5,000",
                                       TRUE ~ NA_character_),
         household_income2 = fct_relevel(household_income2, "Up to R$3,000", "From R$3,001 to R$5,000",
                                         "Above R$5,000"))
cjdt$Income <- factor(cjdt$household_income2)
mm_by <- cj(cjdt, fm, id = ~response_id, estimate = "mm", h0 = 0.5, by = ~Income)

# Plot
plot(mm_by, group = "Income", vline = 0.5, header_fmt = "%s") +
  theme(legend.position = "bottom", axis.text.y = element_text(face = faces, size = 10)) +
  scale_colour_viridis_d(option = "inferno", end = 0.8)

# Tables
mm_3k <- mm_by %>% filter(BY == "Up to R$3,000")
table_mm_by(mm_3k, capt = "Marginal Means -- Up to 3,000 BRL")
mm_5k <- mm_by %>% filter(BY == "From R$3,001 to R$5,000")
table_mm_by(mm_5k, capt = "Marginal Means -- From 3,001 to 5,000 BRL")
mm_abv5k <- mm_by %>% filter(BY == "Above R$5,000")
table_mm_by(mm_abv5k, capt = "Marginal Means -- Above 5,000 BRL")
```
\normalsize

\clearpage

### Political Ideology

Here we disaggregate the results according to political ideology. We see that
political views do not change the overall responses.

\footnotesize
```{r conjoint-ideology, warning=F, message=F, error=F, cache=T, fig.width=7, fig.height=5.2, fig.pos="H"}
# Model
cjdt <- full_join(conjoint_data, df1, by = "response_id") %>%
  drop_na(ideology)
cjdt$Ideology <- factor(cjdt$ideology)
mm_by <- cj(cjdt, fm, id = ~response_id, estimate = "mm", h0 = 0.5, by =
            ~Ideology)

# Plot
plot(mm_by, group = "Ideology", vline = 0.5, header_fmt = "%s") +
  theme(legend.position = "bottom", axis.text.y = element_text(face = faces, size = 10)) +
  scale_colour_viridis_d(option = "inferno", end = 0.8)

# Tables
mm_left <- mm_by %>% filter(BY == "Left")
table_mm_by(mm_left, capt = "Marginal Means -- Left")
mm_center_left <- mm_by %>% filter(BY == "Center-Left")
table_mm_by(mm_center_left, capt = "Marginal Means -- Center-Left")
mm_center <- mm_by %>% filter(BY == "Center")
table_mm_by(mm_center, capt = "Marginal Means -- Center")
mm_center_right <- mm_by %>% filter(BY == "Center-Right")
table_mm_by(mm_center_right, capt = "Marginal Means -- Center-Right")
mm_right <- mm_by %>% filter(BY == "Right")
table_mm_by(mm_right, capt = "Marginal Means -- Right")
mm_dont_know <- mm_by %>% filter(BY == "Don't Know")
table_mm_by(mm_dont_know, capt = "Marginal Means -- Don't Know")
mm_not_say <- mm_by %>% filter(BY == "Rather Not Say")
table_mm_by(mm_not_say, capt = "Marginal Means -- Rather Not Say")
```
\normalsize

\clearpage

### Support for Death Penalty

Here we assess whether subjects who support the death penalty have different
preferences towards lynching victims. There are fewer respondents who answered
"Don't Know" or "Rather Not Say" to our question, so the confidence intervals
from their estimates are larger than for the other two categories. The
estimates largely overlap across the four groups, although those who answered
"Rather Not Say" are less favorable to lynching Indigenous criminals.

\footnotesize
```{r conjoint-penalty, warning=F, message=F, error=F, cache=T, fig.width=7, fig.height=5.3, fig.pos="H"}
# Model
cjdt <- full_join(conjoint_data, df1, by = "response_id") %>%
  drop_na(death_penalty) %>%
  mutate(death_penalty = fct_relevel(death_penalty, "Yes", "No",
                                     "Don't Know", "Rather Not Say"))
cjdt$Death_Penalty <- factor(cjdt$death_penalty)
mm_by <- cj(cjdt, fm, id = ~response_id, estimate = "mm", h0 = 0.5, by = ~Death_Penalty)

# Plot
plot(mm_by, group = "Death_Penalty", vline = 0.5, header_fmt = "%s") +
  theme(legend.position = "bottom", axis.text.y = element_text(face = faces, size = 10)) +
  scale_colour_viridis_d(option = "inferno", end = 0.8)

# Tables
mm_yes <- mm_by %>% filter(BY == "Yes")
table_mm_by(mm_yes, capt = "Marginal Means -- Support for Death Penalty: Yes")
mm_no <- mm_by %>% filter(BY == "No")
table_mm_by(mm_no, capt = "Marginal Means -- Support for Death Penalty: No")
mm_dk <- mm_by %>% filter(BY == "Don't Know")
table_mm_by(mm_dk, capt = "Marginal Means -- Support for Death Penalty: Do Not Know")
mm_rns <- mm_by %>% filter(BY == "Rather Not Say")
table_mm_by(mm_rns, capt = "Marginal Means -- Support for Death Penalty: Rather Not Say")
```
\normalsize

\clearpage

### Previous Victimization

Respondents who had been victimized in the past 12 months also do not have
different preferences towards lynchings victim profiles. The results are
virtually identical for both groups, as one can see below. The only exception is
that respondents who had not been victimized one year prior to the research are
slightly more likely to support the lynching of White criminals.

\footnotesize
```{r conjoint-victimization, warning=F, message=F, error=F, cache=T, fig.width=7, fig.height=5.6, fig.pos="H"}
# Model
cjdt <- full_join(conjoint_data, df1, by = "response_id") %>%
  mutate(previous_victim_dummy, "Yes", "No")
cjdt$Previous_Victim <- factor(cjdt$previous_victim_dummy)
mm_by <- cj(cjdt, fm, id = ~response_id, estimate = "mm", h0 = 0.5, by = ~Previous_Victim)

# Plot
plot(mm_by, group = "Previous_Victim", vline = 0.5, header_fmt = "%s") +
  theme(legend.position = "bottom", axis.text.y = element_text(face = faces, size = 10)) +
  scale_colour_viridis_d(option = "inferno", end = 0.8)

# Tables
mm_yes <- mm_by %>% filter(BY == "Yes")
table_mm_by(mm_yes, capt = "Marginal Means -- Previous Victimization (12 Months): Yes")
mm_no <- mm_by %>% filter(BY == "No")
table_mm_by(mm_no, capt = "Marginal Means -- Previous Victimization (12 Months): No")
```
\normalsize

\clearpage

### Opinion on the Police

Experimental results do not change when we break down the responses according
to how subjects view the police forces.

\footnotesize
```{r conjoint-policing, warning=F, message=F, error=F, cache=T, fig.width=8, fig.height=6, fig.pos="H"}
# Model
cjdt <- full_join(conjoint_data, df1, by = "response_id") %>%
  mutate(views_police2 = case_when(views_police == "Rather Not Say" ~ NA_character_,
                                   views_police == "Don't Know" ~ NA_character_,
                                   TRUE ~ as.character(views_police)),
         views_police2 = fct_relevel(views_police2, "Very Good", "Good",
                                     "Regular", "Bad", "Very Bad")) %>%
  drop_na(views_police2)
cjdt$Police <- factor(cjdt$views_police2)
mm_by <- cj(cjdt, fm, id = ~response_id, estimate = "mm", h0 = 0.5, by = ~Police)

# Plot
plot(mm_by, group = "Police", vline = 0.5, header_fmt = "%s") +
  theme(legend.position = "bottom", axis.text.y = element_text(face = faces, size = 10)) +
  scale_colour_viridis_d(option = "inferno", end = 0.8)

# Tables
mm_vgood <- mm_by %>% filter(BY == "Very Good")
table_mm_by(mm_vgood, capt = "Marginal Means -- Opinion on the Police: Very Good")
mm_good <- mm_by %>% filter(BY == "Good")
table_mm_by(mm_good, capt = "Marginal Means -- Opinion on the Police: Good")
mm_regular <- mm_by %>% filter(BY == "Regular")
table_mm_by(mm_regular, capt = "Marginal Means -- Opinion on the Police: Regular")
mm_bad <- mm_by %>% filter(BY == "Bad")
table_mm_by(mm_bad, capt = "Marginal Means -- Opinion on the Police: Bad")
mm_vbad <- mm_by %>% filter(BY == "Very Bad")
table_mm_by(mm_vbad, capt = "Marginal Means -- Opinion on the Police: Very Bad")
```
\normalsize

\clearpage

### Opinion on the Judicial System

Lastly, we analyze whether personal beliefs about the judicial system affect
the type of lynching victim respondents select.

\footnotesize
```{r conjoint-justice, warning=F, message=F, error=F, cache=T, fig.width=8, fig.height=5.6, fig.pos="H"}
# Model
cjdt <- full_join(conjoint_data, df1, by = "response_id") %>%
  mutate(views_justice2 = case_when(views_justice == "Rather Not Say" ~ NA_character_,
                                    views_justice == "Don't Know" ~ NA_character_,
                                   TRUE ~ as.character(views_justice)),
         views_justice2 = fct_relevel(views_justice2, "Very Good", "Good",
                                      "Regular", "Bad", "Very Bad")) %>%
  drop_na(views_justice2)
cjdt$Judiciary <- factor(cjdt$views_justice2)
mm_by <- cj(cjdt, fm, id = ~response_id, estimate = "mm", h0 = 0.5, by = ~Judiciary)

# Plot
plot(mm_by, group = "Judiciary", vline = 0.5, header_fmt = "%s") +
  theme(legend.position = "bottom", axis.text.y = element_text(face = faces, size = 10)) +
  scale_colour_viridis_d(option = "inferno", end = 0.8)

# Tables
mm_vgood <- mm_by %>% filter(BY == "Very Good")
table_mm_by(mm_vgood, capt = "Marginal Means -- Opinion on the Judicial System: Very Good")
mm_good <- mm_by %>% filter(BY == "Good")
table_mm_by(mm_good, capt = "Marginal Means -- Opinion on the Judicial System: Good")
mm_regular <- mm_by %>% filter(BY == "Regular")
table_mm_by(mm_regular, capt = "Marginal Means -- Opinion on the Judicial System: Regular")
mm_bad <- mm_by %>% filter(BY == "Bad")
table_mm_by(mm_bad, capt = "Marginal Means -- Opinion on the Judicial System: Bad")
mm_vbad <- mm_by %>% filter(BY == "Very Bad")
table_mm_by(mm_vbad, capt = "Marginal Means -- Opinion on the Judicial System: Very Bad")
```
\normalsize

\clearpage

## Text Analysis

In addition to the conjoint experiments, we also asked respondents to justify
their profile choices. We added a text box after each conjoint and informed
subjects that their responses were optional. However, we obtained `r (nrow(df1) - sum(is.na(df1$q13_text))) + (nrow(df1) - sum(is.na(df1$q14_text))) + (nrow(df1) - sum(is.na(df1$q15_text))) + (nrow(df1) - sum(is.na(df1$q16_text))) + (nrow(df1) - sum(is.na(df1$q17_text)))` responses
in our survey, which we analyze here.

First, we concatenate all text responses into a single vector. Then we tokenize
the sentences, remove Portuguese stop words and punctuation, and select the
words that appear most frequently in the texts.

The graphs shows that _crime_ (same as in English), _porque_ (because),
_linchamento_ (lynching), and _caso_ (case) are the words respondents use most
often. This is expected as subjects were asked to justify their choices. The
next words in the list are related to victim or crime characteristics, such as
_criança_ (child), _estupro_ (rape), _assassinato_ (murder), and _vítima_
(victim). Indeed, they provide evidence for our previous findings and confirm
that respondents select lynching victim profiles according to these two
factors. Criminal characteristics, such as age or race, do not seem to be
particularly relevant, as respondents do not mention them as much. Then
respondents mention terms like _nenhum_ (none), _contra_ (against), _acho_ (I
think), _casos_ (cases), _ter_ (have to), and _justiça_ (justice). We believe
these words correspond to cases where respondents wanted to affirm that they do
not have any preference regarding the lynching profiles, or that they would
rather not have chosen any of the alternatives.

\footnotesize
```{r conjoint-text, warning=F, message=F, error=F, cache=T, fig.width=8, fig.height=5.6, fig.pos="H", fig.cap = "Words respondents use most frequently when justifying their choices of lynching profiles"}
dfmat <- df1 %>%
  select(q13_text, q14_text, q15_text, q16_text, q17_text) %>%
  gather() %>%
  corpus(text_field = "value") %>%
  tokens(remove_punct = TRUE, remove_numbers = TRUE,
         remove_symbol = TRUE) %>%
  dfm() %>%
  dfm_remove(., pattern = c(stopwords("pt", source = "snowball"),
                            "é", "ser"))

# Plot
dfmat %>%
  textstat_frequency(n = 15) %>%
  ggplot(aes(x = reorder(feature, frequency), y = frequency)) +
  geom_point(colour = "#152238") +
  coord_flip() +
  labs(x = NULL, y = "Frequency") +
  theme_minimal()
```
\normalsize

We also construct a feature co-occurrence matrix (FCM) that shows which words
appear together in the responses we collected. Again, the results confirm the
findings of the conjoint experiment. As suggested in the previous graph, we see
a central cluster that describes crime and victim characteristics and includes
the words _linchamentos_ (lynchings), _caso_ (case), _estupro_ (rape),
_criança_ (child), _assassinato_ (murder), and _vítima_ (victim). This
highlights that these are the most important reasons why respondents choose
lynching profiles.

We note that there is another word cluster on the left. It contains words
that indicate that some respondents do not support lynchings, such as _não_
(no), _opção_ (choice), _nada_ (nothing), _justifica_ (justifies),
_justificável_ (justifiable), and _escolher_ (choose).

\footnotesize
```{r conjoint-fcm, warning=F, message=F, error=F, cache=T, fig.width=8, fig.height=5.6, fig.pos="H", fig.cap = "Semantic network analysis"}
fcmat <- fcm(dfmat)
feat <- names(topfeatures(fcmat, 70))
fcmat_select <- fcm_select(fcmat, pattern = feat, selection = "keep")
size <- log(colSums(dfm_select(dfmat, feat, selection = "keep")))

# Plot
set.seed(144)
textplot_network(fcmat_select, min_freq = 0.8, vertex_size = size / max(size) * 3, max.overlaps = 30)
```
\normalsize

We estimate a latent Dirichlet allocation (LDA) model to identify the three
most important topics in our corpus. The first topic includes words that refer
to victim and crime characteristics, many of which have also appeared in our
previous estimations. Some of the most common words in this group are _crime_
(crime), _criança_ (child), _estupro_ (rape), _vítima_ (victim), _porque_
(because), _idoso_ (elderly), _grave_ (serious), and _molestar_ (molest). When
we count the number of topics in the corpus, we see that this is the
predominant one. The second topic identified by the model describes lynching
perpetrators, as it contains the words like _polícia_ (police), _pessoas_
(people), and _família_ (family). The third topic identifies the same words we
associate with respondents who are against lynchings, such as _nenhum_ (none),
_opção_ (choice), _não_ (no), and _contra_ (against). As our results show,
respondents decide which individual deserves punishment based on factors
related to the crime he/she committed, especially the crime victim. There is
also a group of respondents that oppose lynchings in principle, who affirm that
lynchings are never justified.

\footnotesize
```{r conjoint-lda, warning=F, message=F, error=F, cache=T, fig.width=10, fig.height=9, fig.post="H"}
# Unsupervized LDA
tmod_lda <- textmodel_lda(dfmat, k = 3)
terms(tmod_lda, 10)
table(topics(tmod_lda))
```
\normalsize

Our last model is a semisupervized LDA, in which we include a series of
keywords to measure how frequently some pre-defined topics appear often in the
responses. We adopt a conservative approach and only include words that we have
a high degree of confidence that are not ambiguous. There are four pre-defined
topics in this estimation. The first refers to victims, and include the
Portuguese words for _children_, _life_, and _victim_ (along with possible
variations). The second topic describes crime characteristics with words such
as _murder_, _rape_, _kill_, _molest_, and _steal_. The next group has four
keywords that describe lynching perpetrators, and they are _gangs_, _family_,
_bystanders_, and _police_. The fourth topic includes terms to identify
respondents who are against lynchings, and we added _against_, _none_, _do not
agree_, and _choice_ as seed terms. We see that the topic describing crime
characteristics is the one that appears more often.

\footnotesize
```{r conjoint-seededlda, warning=F, message=F, error=F, cache=T, fig.width=15, fig.height=9, fig.pos="H"}
# Semisupervized LDA
keywords <- dictionary(list(victim      = c("crian*", "vida*", "v*tima*"),
                            crime       = c("assassin*", "estupr*", "mata*", "molest*", "roub*"),
                            perpetrator = c("gang*", "fam*lia*", "pedestr*", "pol*cia*"),
                            against     = c("contra", "escolha", "nenhum*", "n*o concord*", "op**o")))

slda <- textmodel_seededlda(dfmat, keywords, residual = TRUE)
terms(slda, 10)
table(topics(slda))
```
\normalsize

# Experiment 02

## Description

Our second experiment measures the effect of information provision on attitudes
about lynching. In particular, we test whether reminding respondents
about the legal and social consequences of vigilante justice reduces the
subjects' level of support for such practice.[^carryover-effects]

[^carryover-effects]: To prevent eventual carryover effects caused by the
conjoint, we randomized the order of the conjoint and the information provision
experiments [@perreault1975controlling].

The experiment has three treatment conditions and a control group. In all of
them we present respondents with a short statement affirming that some
Brazilians support vigilantism under certain conditions. Respondents were asked
to use 0 to 49 if they disagree, 50 if they neither agree nor disagree, and
50-100 if they agree with the sentence.

Each of the three treatment groups received a different message about the
legal or social consequences of lynching in Brazil. In the first treatment
arm, we informed subjects about how the Brazilian constitution and penal code
punishes civilian violence. The second treatment group was notified about
the human rights guarantees enshrined in Brazil's legal framework. The last
group read a vignette that mentions how lynchings can spark _vendettas_ and
initiate a cycle of violence in the community. Subjects in the control group
received no information about the consequences of lynchings. The text shown
to the control and treatment groups can be read below.

* *Control group*: In Brazil, some people believe that lynching may be
  justified under certain conditions. To what degree do you agree or disagree
  that lynching can be justified? Please use the slider below to indicate your
  preference. For disagreement, use 0 to 49; for agreement, use 51 to 100.
  Please use 50 if you neither agree nor disagree.[^control-exp03]

[^control-exp03]: In Portuguese: No Brasil, algumas pessoas acreditam que
linchamentos são justificados sob certas condições. O quanto você concorda ou
discorda que linchamentos podem ser justificados? Por favor, use a barra abaixo
para indicar sua preferência. Para indicar que discorda, use de 0 a 49; para
concordar, use de 51 a 100. Por favor, use 50 caso você não concorde nem
discorde.

* *Treatment 01 - Legal punishment for lynching perpetrators*: In Brazil,
  some people believe that lynching may be justified under certain conditions.
  **However, the Brazilian constitution and penal code strictly forbid
  lynching and those involved can be accused of torture or murder**. To what
  degree do you agree or disagree that lynching can be justified? Please use
  the slider below to indicate your preference. For disagreement, use 0 to 49;
  for agreement, use 51 to 100. Please use 50 if you neither agree nor
  disagree.[^treat01-exp03]

[^treat01-exp03]: In Portuguese: No Brasil, algumas pessoas acreditam que
linchamentos são justificados sob certas condições. **Entretanto, a
constituição e o código penal do Brasil proíbem estritamente os linchamentos e
os envolvidos podem ser acusados de tortura ou assassinato.** O quanto você
concorda ou discorda que linchamentos podem ser justificados? Por favor, use a
barra abaixo para indicar sua preferência. Para indicar que discorda, use de 0
a 49; para concordar, use de 51 a 100. Por favor, use 50 caso você não concorde
nem discorde.

* *Treatment 02 - Human rights*: In Brazil, some people believe that lynching
  may be justified under certain conditions. **However, the Brazilian
  constitution states that all individuals have the right of not being
  tortured, including criminals**. To what degree do you agree or disagree that
  lynching can be justified? Please use the slider below to indicate your
  preference. For disagreement, use 0 to 49; for agreement, use 51 to 100.
  Please use 50 if you neither agree nor disagree.[^treat02-exp03]

[^treat02-exp03]: In Portuguese: No Brasil, algumas pessoas acreditam que
linchamentos são justificados sob certas condições. **Entretanto, a
constituição do Brasil afirma que todos os indivíduos têm o direito de não
serem torturados, inclusive criminosos**. O quanto você concorda ou discorda que
linchamentos podem ser justificados? Por favor, use a barra abaixo para indicar
sua preferência. Para indicar que discorda, use de 0 a 49; para concordar, use
de 51 a 100. Por favor, use 50 caso você não concorde nem discorde.

* *Treatment 03 - Vendettas*: In Brazil, some people believe that lynching
  may be justified under certain conditions. **However, lynchings can trigger
  a new cycle of violence as the family or friends of the victim may retaliate
  the community**. To what degree do you agree or disagree that lynching can be
  justified? Please use the slider below to indicate your preference. For
  disagreement, use 0 to 49; for agreement, use 51 to 100. Please use 50 if you
  neither agree nor disagree.[^treat03-exp03]

[^treat03-exp03]: In Portuguese: No Brasil, algumas pessoas acreditam que
linchamentos são justificados sob certas condições. **Entretanto, linchamentos
podem iniciar um ciclo de violência pois a família ou amigos da vítima podem
retaliar a comunidade**. O quanto você concorda ou discorda que linchamentos
podem ser justificados? Por favor, use a barra abaixo para indicar sua
preferência. Para indicar que discorda, use de 0 a 49; para concordar, use de
51 a 100. Por favor, use 50 caso você não concorde nem discorde.

## Main Results

Our results are available in table \ref{tab:exp03main}. Reminding respondents
of the legal consequences of lynchings has a strong, negative effect on
individual levels of lynching support. We see a reduction of about 4.5%, which
corresponds to an 11% change when compared to the baseline levels. Our second
treatment condition, reminding subjects of human rights guarantees, has no
statistically significant effect. Informing respondents that lynchings can
trigger a cycle of violence also has a large negative effect. It decreases
lynching support by 3%, which is an 8% reduction in comparison with the control
group. When we combine all treatments, we still detect a negative impact of the
treatment conditions.

\footnotesize
```{r exp03-main, warning=F, message=F, error=F, cache=T, fig.pos="H", results='asis'}
df_exp03 <- df1 %>%
  mutate(exp03_outcomes = coalesce(exp03_control, exp03_constitution, exp03_rights, exp03_vendetta),
         exp03_any_treat = case_when(!is.na(exp03_control) ~ "0", !is.na(exp03_constitution) ~ "1",
                                     !is.na(exp03_rights) ~ "1", !is.na(exp03_vendetta) ~ "1",
                                     TRUE ~ NA_character_),
         exp03_constitution_treat = case_when(!is.na(exp03_control) ~ "0",
                                              !is.na(exp03_constitution) ~ "1"),
         exp03_rights_treat = case_when(!is.na(exp03_control) ~ "0",
                                        !is.na(exp03_rights) ~ "1"),
         exp03_vendetta_treat = case_when(!is.na(exp03_control) ~ "0",
                                          !is.na(exp03_vendetta) ~ "1"))

m1 <- lm(exp03_outcomes ~ exp03_constitution_treat, data = df_exp03)
m2 <- lm(exp03_outcomes ~ exp03_rights_treat, data = df_exp03)
m3 <- lm(exp03_outcomes ~ exp03_vendetta_treat, data = df_exp03)
m4 <- lm(exp03_outcomes ~ exp03_any_treat, data = df_exp03)

stargazer(m1, m2, m3, m4, se = starprep(m1, m2, m3, m4), header = FALSE,
          p = starprep(m1, m2, m3, m4, stat = "p.value"), align = TRUE,
          title = "Experiment 03 -- Main Results", style = "apsr", label = "tab:exp03main",
          dep.var.labels = "\\textbf{Lynching Support}\\vspace{.5cm}",
          covariate.labels = c("Constitution and penal code", "Human rights",
                               "Vendettas", "Combined treatments"),
          column.sep.width = "3pt", notes = "Robust standard errors in parentheses.",
          keep.stat = "n", no.space = TRUE)

```
\normalsize

## Determinants of Baseline Levels

We also evaluate how individual characteristics
impact lynching support. We find that the coefficient for white
respondents is negative in two estimations, and the coefficient for male does
not reach statistical significance in the last model ($p$-value = 0.11).
Political ideology is strongly correlated with support for lynchings.

\footnotesize
```{r exp03-baseline, warning=F, message=F, error=F, cache=T, fig.pos="H", results='asis'}
df_exp03_group <- df_exp03 %>%
  filter(gender == c("Female", "Male"),
         race %in% c("Asian", "Black", "Mixed Race", "White"),
         ideology %in% c("Center", "Center-Left", "Center-Right", "Left", "Right")) %>%
  mutate(race = fct_relevel(race, "Black"), ideology = fct_relevel(ideology, "Center"))

df_exp03_gender <- df_exp03 %>% filter(gender == c("Female", "Male"))
df_exp03_race <- df_exp03 %>% filter(race %in% c("Asian", "Black", "Mixed Race", "White")) %>%
  mutate(race = fct_relevel(race, "Black"))
df_exp03_ideology <- df_exp03 %>%
         filter(ideology %in% c("Center", "Center-Left", "Center-Right", "Left", "Right")) %>%
         mutate(ideology = fct_relevel(ideology, "Center"))

m1 <- lm(exp03_outcomes ~ gender, data = df_exp03_gender)
m2 <- lm(exp03_outcomes ~ race, data = df_exp03_race)
m3 <- lm(exp03_outcomes ~ ideology, data = df_exp03_ideology)
m4 <- lm(exp03_outcomes ~ gender + race + ideology, data = df_exp03_group)

stargazer(m1, m2, m3, m4, se = starprep(m1, m2, m3, m4), p = starprep(m1, m2, m3, m4, stat = "p.value"),
          header = FALSE, align = TRUE, label = "tab:exp03baseline",
          title = "Experiment 01 -- Determinants of Baseline Levels of
          Lynching Support", style = "apsr", dep.var.labels = "\\textbf{Lynching Support}\\vspace{.5cm}",
          covariate.labels = c("Male", "Asian", "Mixed Race", "White",
                               "Left", "Center-Left", "Center-Right", "Right"),
          column.sep.width = "3pt", notes = "Robust standard errors in parentheses.",
          keep.stat = "n", no.space = TRUE)
```
\normalsize

## Heterogeneous Effects

In this section, we explore whether our pre-treatment covariates impact the
treatment effect. We use the same flexible approach we employed in the previous
experiment, and estimate all models using Bayesian Additive Regression Trees
(BART). The algorithm produces average treatment effects for each category in
the moderator variables.

### Treatment 01: Legal Punishment for Lynching Perpetrators

We find no evidence of heterogeneous effects in this treatment condition. All
coefficients are largely similar across all model specifications.

\footnotesize
```{r exp03-bart01, warning=F, error=F, message=F, cache=T}
df_exp03_het <- df_exp03 %>%
  filter(gender %in% c("Female", "Male")) %>%
  mutate(race = fct_relevel(race, "White", "Black", "Mixed Race", "Asian",
                            "Indigenous"),
         education = fct_relevel(education, "Primary School", "Secondary School",
                                  "High School", "College", "Graduate School"),
         views_police = fct_relevel(views_police, "Regular", "Very Good", "Good",
                                    "Bad", "Very Bad"),
         views_justice = fct_relevel(views_justice, "Regular", "Very Good", "Good",
                                     "Bad", "Very Bad"),
         ideology = fct_relevel(ideology, "Center", "Left", "Center-Left",
                                "Center-Right", "Right", "Don't Know", "Rather Not Say"),
         household_income = fct_relevel(household_income, "Up to R$1,000", "From R$1,001 to R$2,000",
                                         "From R$2,001 to R$3,000", "From R$3,001 to R$5,000",
                                         "From R$5,001 to R$10,000", "From R$10,001 to R$20,000",
                                         "Above R$20,000"),
         previous_victim_dummy = fct_relevel(previous_victim_dummy, "Yes", "No"),
         death_penalty = fct_relevel(death_penalty, "Yes", "No"),
         age2 = case_when(age >= 18 & age <= 34 ~ "18-34", age >= 35 & age <= 54 ~ "35-54",
                          age >= 55 ~ "55 plus", TRUE ~ as.character(age)))

df_exp03_constitution <- df_exp03_het %>%
  mutate(exp03_constitution_treat = as.numeric(exp03_constitution_treat)) %>%
  drop_na(exp03_constitution_treat)

# Gender
summary(bartc(exp03_outcomes, exp03_constitution_treat, gender,
              group.by = gender, group.effects = TRUE, data = df_exp03_constitution,
              n.chains = 5L, seed = 144))

# Age
df_exp03_constitution2 <- df_exp03_constitution %>% drop_na(age2)
summary(bartc(exp03_outcomes, exp03_constitution_treat, age2,
              group.by = age2, group.effects = TRUE, data = df_exp03_constitution2,
              n.chains = 5L, seed = 144))

# Race
summary(bartc(exp03_outcomes, exp03_constitution_treat, race,
              group.by = race, group.effects = TRUE, data = df_exp03_constitution,
              n.chains = 5L, seed = 144))

# Education
summary(bartc(exp03_outcomes, exp03_constitution_treat, education,
              group.by = education, group.effects = TRUE, data = df_exp03_constitution,
              n.chains = 5L, seed = 144))

# Household Income
summary(bartc(exp03_outcomes, exp03_constitution_treat, household_income,
              group.by = household_income, group.effects = TRUE, data = df_exp03_constitution,
              n.chains = 5L, seed = 144))

# Political Ideology
summary(bartc(exp03_outcomes, exp03_constitution_treat, ideology,
              group.by = ideology, group.effects = TRUE, data = df_exp03_constitution,
              n.chains = 5L, seed = 144))

# Support for Death Penalty
summary(bartc(exp03_outcomes, exp03_constitution_treat, death_penalty,
              group.by = death_penalty, group.effects = TRUE, data = df_exp03_constitution,
              n.chains = 5L, seed = 144))

# Previous Victimization
df_exp03_constitution2 <- df_exp03_constitution %>% drop_na(previous_victim_dummy)
summary(bartc(exp03_outcomes, exp03_constitution_treat, previous_victim_dummy,
              group.by = previous_victim_dummy, group.effects = TRUE, data = df_exp03_constitution2,
              n.chains = 5L, seed = 144))

# Opinion on the Police
summary(bartc(exp03_outcomes, exp03_constitution_treat, views_police,
              group.by = views_police, group.effects = TRUE, data = df_exp03_constitution,
              n.chains = 5L, seed = 144))

# Opinion on the Judicial System
summary(bartc(exp03_outcomes, exp03_constitution_treat, views_justice,
              group.by = views_police, group.effects = TRUE, data = df_exp03_constitution,
              n.chains = 5L, seed = 144))
```
\normalsize

### Treatment 02: Human Rights

Our results show no presence of heterogeneous effects.

\footnotesize
```{r exp03-bart02, warning=F, error=F, message=F, cache=T}
df_exp03_rights <- df_exp03_het %>%
  mutate(exp03_rights_treat = as.numeric(exp03_rights_treat)) %>%
  drop_na(exp03_rights_treat)

# Gender
summary(bartc(exp03_outcomes, exp03_rights_treat, gender,
              group.by = gender, group.effects = TRUE, data = df_exp03_rights,
              n.chains = 5L, seed = 144))

# Age
df_exp03_rights2 <- df_exp03_rights %>% drop_na(age2)
summary(bartc(exp03_outcomes, exp03_rights_treat, age2,
              group.by = age2, group.effects = TRUE, data = df_exp03_rights2,
              n.chains = 5L, seed = 144))

# Race
summary(bartc(exp03_outcomes, exp03_rights_treat, race,
              group.by = race, group.effects = TRUE, data = df_exp03_rights,
              n.chains = 5L, seed = 144))

# Education
summary(bartc(exp03_outcomes, exp03_rights_treat, education,
              group.by = education, group.effects = TRUE, data = df_exp03_rights,
              n.chains = 5L, seed = 144))

# Household Income
summary(bartc(exp03_outcomes, exp03_rights_treat, household_income,
              group.by = household_income, group.effects = TRUE, data = df_exp03_rights,
              n.chains = 5L, seed = 144))

# Political Ideology
summary(bartc(exp03_outcomes, exp03_rights_treat, ideology,
              group.by = ideology, group.effects = TRUE, data = df_exp03_rights,
              n.chains = 5L, seed = 144))

# Support for Death Penalty
summary(bartc(exp03_outcomes, exp03_rights_treat, death_penalty,
              group.by = death_penalty, group.effects = TRUE, data = df_exp03_rights,
              n.chains = 5L, seed = 144))

# Previous Victimization
df_exp03_rights2 <- df_exp03_rights %>% drop_na(previous_victim_dummy)
summary(bartc(exp03_outcomes, exp03_rights_treat, previous_victim_dummy,
              group.by = previous_victim_dummy, group.effects = TRUE, data = df_exp03_rights2,
              n.chains = 5L, seed = 144))

# Opinion on the Police
summary(bartc(exp03_outcomes, exp03_rights_treat, views_police,
              group.by = views_police, group.effects = TRUE, data = df_exp03_rights,
              n.chains = 5L, seed = 144))

# Opinion on the Judicial System
summary(bartc(exp03_outcomes, exp03_rights_treat, views_justice,
              group.by = views_police, group.effects = TRUE, data = df_exp03_rights,
              n.chains = 5L, seed = 144))
```
\normalsize

### Treatment 03: Vendettas

We do not find considerable heterogeneity in the results. Overall, the
three treatment conditions are very stable, thus we are confident that the
main results are not driven by any particular group.

\footnotesize
```{r exp03-bart03, warning=F, error=F, message=F, cache=T}
df_exp03_vendetta <- df_exp03_het %>%
  mutate(exp03_vendetta_treat = as.numeric(exp03_vendetta_treat)) %>%
  drop_na(exp03_vendetta_treat)

# Gender
summary(bartc(exp03_outcomes, exp03_vendetta_treat, gender,
              group.by = gender, group.effects = TRUE, data = df_exp03_vendetta,
              n.chains = 5L, seed = 144))

# Age
df_exp03_vendetta2 <- df_exp03_vendetta %>% drop_na(age2)
summary(bartc(exp03_outcomes, exp03_vendetta_treat, age2,
              group.by = age2, group.effects = TRUE, data = df_exp03_vendetta2,
              n.chains = 5L, seed = 144))

# Race
summary(bartc(exp03_outcomes, exp03_vendetta_treat, race,
              group.by = race, group.effects = TRUE, data = df_exp03_vendetta,
              n.chains = 5L, seed = 144))

# Education
summary(bartc(exp03_outcomes, exp03_vendetta_treat, education,
              group.by = education, group.effects = TRUE, data = df_exp03_vendetta,
              n.chains = 5L, seed = 144))

# Household Income
summary(bartc(exp03_outcomes, exp03_vendetta_treat, household_income,
              group.by = household_income, group.effects = TRUE, data = df_exp03_vendetta,
              n.chains = 5L, seed = 144))

# Political Ideology
summary(bartc(exp03_outcomes, exp03_vendetta_treat, ideology,
              group.by = ideology, group.effects = TRUE, data = df_exp03_vendetta,
              n.chains = 5L, seed = 144))

# Support for Death Penalty
summary(bartc(exp03_outcomes, exp03_vendetta_treat, death_penalty,
              group.by = death_penalty, group.effects = TRUE, data = df_exp03_vendetta,
              n.chains = 5L, seed = 144))

# Previous Victimization
df_exp03_vendetta2 <- df_exp03_vendetta %>% drop_na(previous_victim_dummy)
summary(bartc(exp03_outcomes, exp03_vendetta_treat, previous_victim_dummy,
              group.by = previous_victim_dummy, group.effects = TRUE, data = df_exp03_vendetta2,
              n.chains = 5L, seed = 144))

# Opinion on the Police
summary(bartc(exp03_outcomes, exp03_vendetta_treat, views_police,
              group.by = views_police, group.effects = TRUE, data = df_exp03_vendetta,
              n.chains = 5L, seed = 144))

# Opinion on the Judicial System
summary(bartc(exp03_outcomes, exp03_vendetta_treat, views_justice,
              group.by = views_police, group.effects = TRUE, data = df_exp03_vendetta,
              n.chains = 5L, seed = 144))
```
\normalsize

# Ethics Statement

We adhered to the ethical guidelines provided by the Institutional Review Board
at Brown University and APSA's Principles and Guidance. To facilitate
transparency, we comment here on a few aspects of our research design. First, we
worked with Brown University's IRB to reduce the risk of harm for participants
taking the survey. This included consultation with a cultural expert to inform
the phrasing of the survey. Second, respondents received compensation via
Qualtrics, which paid respondents directly after they completed the
questionnaire. Each subject in Qualtrics' online panel received the equivalent
of 2.5 USD in Brazilian Reals (local currency). Respondents who did not finish
the survey did not receive compensation. The compensation was appropriate for
the participant population. As of August 17, 2020, Brazil's monthly minimum wage
was BRL 1039, which amounted to 191 US dollars. Assuming 40 working hours per
week, the hourly minimum wage equals 1.19 US dollars. Our survey took about 20
minutes to complete and respondents received 2.5 USD, therefore subjects
received a monetary compensation that was 6 times higher than the local minimum
wage. Third, we do not see any potential or perceived conflicts of interest in
carrying out this research. We received a grant of USD 10,000 to conduct this
research from the Centre for the Study of Governance & Society at King’s College
London, which in turn receives support from the Templeton Foundation. We are not
aware of any conflicts of interest from either source. All of the code and data
used in this article have already been made publicly available. 

# Session Information

\footnotesize
```{r session, cache=T}
sessionInfo()
```
\normalsize

