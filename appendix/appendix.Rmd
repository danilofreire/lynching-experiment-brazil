---
title: |
       | Supplementary Materials for "Casting the First Stone: Understanding Attitudes towards Lynching in Brazil"
author:
- "Danilo Freire[^freire]"
- "David Skarbek[^skarbek]"
date: \today
fontfamily: libertine
fontawesome: yes
fontsize: 12pt
monospace-url: yes
spacing: double
papersize: a4paper
bibliography: ../article/references.bib
biblio-style: apalike
output:
  pdf_document:
    citation_package: natbib
    fig_caption: yes
    number_sections: yes
    toc: true
    keep_tex: yes
    template: template.latex
---

[^freire]: Independent Researcher, <danilofreire@gmail.com>, <http://danilofreire.github.io>. Corresponding author.

[^skarbek]: The Department of Political Science and the Political Theory Project, Brown University, Providence, RI, USA, <davidskarbek@brown.edu>, <http://davidskarbek.com>.

\newpage

# Introduction

This appendix contains the `R` code required to replicate the results we
present in "_Casting the First Stone: Understanding Attitudes towards Lynching
in Brazil_". This file also includes the descriptive statistics of our sample,
the average marginal component effects (AMCEs) for our conjoint experiment,
additional subgroup analyses for all three experiments, and a standard report
which follows APSA's guidelines for experimental research [@gerber2014reporting].

The code below loads the required datasets and the `R` packages we use in our
statistical analyses. It also translates the names of the factor variables from
Portuguese into English.

\footnotesize
```{r loading, warning=F, error=F, cache=T}
# Install and load required packages
packages <- c("cjoint", "cregg", "kableExtra",
              "janitor", "stargazer", "tidyverse")
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
  install.packages(packages[!installed_packages])
}
invisible(lapply(packages, library, character.only = TRUE))

# Load the dataset, remove unused rows and columns,
# and convert variable names to snake case
df <- read_csv("../data/data.csv") %>%
  clean_names() %>%
  mutate(response_id            = as.character(response_id),
         consent                = as.factor(q1),
         progress               = as.numeric(progress),
         finished               = as.factor(finished),
         age                    = as.numeric(q2),
         gender                 = as.factor(q3),
         race                   = as.factor(q4),
         education              = as.factor(q5),
         region                 = as.factor(q6),
         household_income       = as.factor(q7),
         ideology               = as.factor(q8),
         death_penalty          = as.factor(q9),
         previous_victim        = as.character(q10),
         previous_victim_text   = as.character(q10_text),
         views_police           = as.factor(q11),
         views_justice          = as.factor(q12),
         exp02_control          = as.numeric(q18),
         exp02_police           = as.numeric(q19),
         exp02_slow_justice     = as.numeric(q20),
         exp02_small_punishment = as.numeric(q21),
         exp03_control          = as.numeric(q22),
         exp03_constitution     = as.numeric(q23),
         exp03_rights           = as.numeric(q24),
         exp03_vendetta         = as.numeric(q25)) %>%
  slice(-1L) %>%
  select(-c(q1:q12, q18:q25)) %>%
  relocate(response_id, consent, progress, finished,
           location_latitude, location_longitude) %>%
  mutate(across(where(is.character), tolower)) %>%
  mutate(across(where(is.factor), tolower))

# Translate factor values from Portuguese to English
df <- df %>%
  mutate(consent = recode(consent,
                          "concordo"     = "Agree",
                          "não concordo" = "Disagree"),
         gender = recode(gender,
                         "feminino"              = "Female",
                         "masculino"             = "Male",
                         "outro"                 = "Other",
                         "prefiro não responder" = "Rather Not Say"),
         race = recode(race,
                       "amarela"               = "Asian",
                       "branca"                = "White",
                       "indígena"              = "Indigenous",
                       "outra"                 = "Other",
                       "parda"                 = "Mixed Race",
                       "prefiro não responder" = "Rather Not Say",
                       "preta"                 = "Black"),
         education = recode(education,
                            "da 1ª à 4ª série do ensino fundamental (antigo primário)" = "Primary School",
                            "da 5ª à 8ª série do ensino fundamental (antigo ginásio)"  = "Secondary School",
                            "ensino médio (antigo 2º grau)"                            = "High School",
                            "ensino superior"                                          = "College",
                            "mestrado ou doutorado"                                    = "Graduate School",
                            "não sei"                                                  = "Don't Know"),
         region = recode(region,
                         "centro-oeste" = "Center-West",
                         "nordeste"     = "Northeast",
                         "norte"        = "North",
                         "sudeste"      = "Southeast",
                         "sul"          = "South"),
         household_income = recode(household_income,
                                   "acima de r$ 20.000"       = "Above R$20,000",
                                   "até r$ 1.000"             = "Up to R$1,000",
                                   "de r$ 1.001 a r$ 2.000"   = "From R$1,001 to R$2,000",
                                   "de r$ 10.000 a r$ 20.000" = "From R$10,001 to R$20,000",
                                   "de r$ 2.001 a r$ 3.000"   = "From R$2,001 to R$3,000",
                                   "de r$ 3.001 a r$ 5.000"   = "From R$3,001 to R$5,000",
                                   "de r$ 5.001 a r$ 10.000"  = "From R$5,001 to R$10,000"),
         ideology = recode(ideology,
                           "centro"                = "Center",
                           "centro-direita"        = "Center-Right",
                           "centro-esquerda"       = "Center-Left",
                           "direita"               = "Right",
                           "esquerda"              = "Left",
                           "não sei"               = "Don't Know",
                           "prefiro não responder" = "Rather Not Say"),
         death_penalty = recode(death_penalty,
                                "não"                   = "No",
                                "não sei"               = "Don't Know",
                                "prefiro não responder" = "Rather Not Say",
                                "sim"                   = "Yes"),
         views_police = recode(views_police,
                               "boa"                   = "Good",
                               "muito boa"             = "Very Good",
                               "muito ruim"            = "Very Bad",
                               "não sei"               = "Don't Know",
                               "prefiro não responder" = "Rather Not Say",
                               "regular"               = "Regular",
                               "ruim"                  = "Bad"),
         views_justice = recode(views_justice,
                                "boa"                   = "Good",
                                "muito boa"             = "Very Good",
                                "muito ruim"            = "Very Bad",
                                "não sei"               = "Don't Know",
                                "prefiro não responder" = "Rather Not Say",
                                "regular"               = "Regular",
                                "ruim"                  = "Bad"),
         previous_victim_dummy = recode(previous_victim,
                                        "nenhum" = "No",
                                        .missing = NA_character_,
                                        .default = "Yes")) %>%
relocate(response_id:previous_victim, previous_victim_dummy,
         previous_victim_text:f_5_2_8)

# Check for duplicated values
count(get_dupes(df))
```
\normalsize

# Descriptive Statistics

```{r samplesize, echo=F, warning=F, error=F, cache=T}
df1 <- df %>% filter(consent == "Agree")
```

We ran our survey experiments from October 30 to December 14 via Qualtrics. Our
sample includes `r nrow(df1)` Brazilians older than 18 years of age from the
five regions of the country (Center-West, North, Northeast, South, and
Southeast). We used quotas for gender and region to ensure that our sample was
similar to the Brazilian population in those characteristics. We also collected
information about whether the subjects had been victimized in the previous 12
months, as well as their opinion the Brazilian judicial system and the police
forces. They follow in the graphs and tables below.

## Informed Consent

About 98% of the interviewees agreed to participate in the survey experiment.
We therefore exclude the remaining cases from the dataset.

\footnotesize
```{r consent, warning=F, error=F, cache=T}
df %>%
  group_by(consent) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 2)) %>%
  rename(Consent = consent) %>%
  kbl(., booktabs = TRUE, caption = "Informed Consent") %>%
  row_spec(0, bold = TRUE) %>%
  kable_styling(latex_options = "hold_position")

# Remove subjects who did not agree with consent form
df1 <- df %>% filter(consent == "Agree")
```
\normalsize

## Gender

The gender distribution of our sample is described below. It closely matches
the official data from the [Brazilian Census
Bureau](https://educa.ibge.gov.br/jovens/conheca-o-brasil/populacao/18320-quantidade-de-homens-e-mulheres.html),
which states that women are 51.8% of the population and men comprise 48.2%.

\footnotesize
```{r gender, warning=F, error=F, cache=T}
df1 %>%
  group_by(gender) %>%
  filter(!is.na(gender)) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 3)) %>%
  rename(Gender = gender) %>%
  kbl(., booktabs = TRUE, caption = "Gender") %>%
  row_spec(0, bold = TRUE) %>%
  kable_styling(latex_options = "hold_position")
```
\normalsize

## Age

The age distribution of our sample is shown below. The median age of the survey
respondents is `r round(median(df1$age, na.rm=T), 1)` years old, which
indicates that our sample is older than the Brazilian population (median age $=
33.4$ years old) [@ciafactbook2020].

\footnotesize
```{r age, warning=F, error=F, cache=T, fig.width=6, fig.height=4.3}
tibble(` `    = "Age",
       Median = round(median(df1$age, na.rm = TRUE), 2),
       Mean   = round(mean(df1$age, na.rm = TRUE), 2),
       SD     = round(sd(df1$age, na.rm = TRUE), 2),
       Min    = min(df1$age, na.rm = TRUE),
       Max    = max(df1$age, na.rm = TRUE),
       `NA`   = sum(is.na(df1$age))) %>%
kbl(., booktabs = TRUE, caption = "Age") %>%
row_spec(0, bold = TRUE) %>%
kable_styling(latex_options = "hold_position")

ggplot(subset(df1, !is.na(age)), aes(age)) +
  geom_bar(fill = "#152238") +
  labs(title = "Age Distribution", x = "Age", y = "Count") +
  geom_vline(aes(xintercept = mean(age, na.rm = TRUE)),
            color = "darkred", linetype = 5, size = 0.5) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))
```
\normalsize

## Race

The next demographic variable we show here is race. According to the [Brazilian
Census Bureau](https://educa.ibge.gov.br/jovens/conheca-o-brasil/populacao/18319-cor-ou-raca.html),
42.7% of the Brazilian population identify as White, 46.8% as Mixed Race, 9.4%
as Blacks, and 1,1% as Asians or Indigenous. As we see below, our sample
includes more Whites and fewer individuals who identify as Mixed Race. The
number of Blacks roughly coincide with the population statistics.

\footnotesize
```{r race, warning=F, error=F, cache=T}
df1 %>%
  group_by(race) %>%
  filter(!is.na(race)) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 3)) %>%
  rename(Race = race) %>%
  kbl(., booktabs = TRUE,  linesep = "",
      caption = "Race") %>%
  row_spec(0, bold = TRUE) %>%
  kable_styling(latex_options = "hold_position")
```
\normalsize

## Education

```{r educationtext, echo=F, warning=F, error=F, cache=T}
df2 <- df1 %>%
  group_by(education) %>%
  filter(!is.na(education)) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 3)) %>%
  rename(Education = education)
```

As expected, our sample is also more educated than [the Brazilian
population](https://educa.ibge.gov.br/jovens/conheca-o-brasil/populacao/18317-educacao.html).
About `r df2[1, 3]*100`% of the respondents have a college degree, and `r df2[3, 3]`% 
have graduate school education. 

\footnotesize
```{r education, warning=F, error=F, cache=T}
df1 %>%
  group_by(education) %>%
  filter(!is.na(education)) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 3)) %>%
  rename(Education = education) %>%
  kbl(., booktabs = TRUE,  linesep = "",
      caption = "Education") %>%
  row_spec(0, bold = TRUE) %>%
  kable_styling(latex_options = "hold_position")
```
\normalsize

## Household Income

```{r incometext, echo=F, warning=F, error=F, cache=T}
df2 <- df1 %>%
  group_by(household_income) %>%
  filter(!is.na(household_income)) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 3)) %>%
  rename(`Household Income` = household_income)
```

In terms of household income, `r df2[6, 3]*100`% of the respondents earns from
R\$5,0001 to R\$10,000 per month (US\$920 to US\$1840 as of January 2021), which
comprise the largest group in our sample. However, the sample also contains 
`r df2[2, 3]*100`% of participants whose household income ranges between R\$1,001
and R\$2,000 (US\$ 185 to US\$370) and `r df2[7, 3]*100`% with household incomes
up to R\$1,000, which is roughly equivalent to Brazil's monthly minimum wage. In
this respect, we have reached participants from all social classes.

\footnotesize
```{r income, warning=F, error=F, cache=T}
df1 %>%
  group_by(household_income) %>%
  filter(!is.na(household_income)) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 3)) %>%
  rename(`Household Income` = household_income) %>%
  kbl(., booktabs = TRUE,  linesep = "",
      caption = "Household Income") %>%
  row_spec(0, bold = TRUE) %>%
  kable_styling(latex_options = "hold_position")
```
\normalsize

## Political Ideology

```{r ideologytext, echo=F, warning=F, error=F, cache=T}
df2 <- df1 %>%
  group_by(ideology) %>%
  filter(!is.na(ideology)) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 3)) %>%
  rename(Ideology = ideology)
```

We have also collected information regarding the subjects' political ideology.
Most respondents identify themselves as right-wingers (`r df2[7, 3]*100`%),
followed by left-wingers (`r df2[5, 3]*100`%), and centrists (`r df2[1, 3]*100`%).
Subjects who do not know their ideology or prefer not to tell their
political beliefs are also large in number (`r df2[4, 3]*100`% and 
`r df2[6, 3]*100`%, respectively).

\footnotesize
```{r ideology, warning=F, error=F, cache=T}
df1 %>%
  group_by(ideology) %>%
  filter(!is.na(ideology)) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 3)) %>%
  rename(Ideology = ideology) %>%
  kbl(., booktabs = TRUE,  linesep = "",
      caption = "Political Ideology") %>%
  row_spec(0, bold = TRUE) %>%
  kable_styling(latex_options = "hold_position")
```
\normalsize

## Support for Death Penalty

Below you may find how many respondents support the death penalty.

\footnotesize
```{r deathpenalty, warning=F, error=F, cache=T}
df1 %>%
  group_by(death_penalty) %>%
  filter(!is.na(death_penalty)) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 3)) %>%
  rename(`Support for Death Penalty` = death_penalty) %>%
  kbl(., booktabs = TRUE,  linesep = "",
      caption = "Support for Death Penalty") %>%
  row_spec(0, bold = TRUE) %>%
  kable_styling(latex_options = "hold_position")
```
\normalsize

## Previous Victimization

We asked subjects whether they had victimized in the previous 12 months, as
crime victims may be more likely to support lynchings. The responses follow
below.

\footnotesize
```{r victimization, warning=F, error=F, cache=T}
df1 %>%
  group_by(previous_victim_dummy) %>%
  filter(!is.na(previous_victim_dummy)) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 3)) %>%
  rename(Victimization = previous_victim_dummy) %>%
  kbl(., booktabs = TRUE,  linesep = "",
      caption = "Previous Victimization (12 Months)") %>%
  row_spec(0, bold = TRUE) %>%
  kable_styling(latex_options = "hold_position")
```
\normalsize

## Opinion on the Police

Here we show the results for our question on how respondents see the police
forces.

\footnotesize
```{r police, warning=F, error=F, cache=T}
df1 %>%
  group_by(views_police) %>%
  filter(!is.na(views_police)) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 3)) %>%
  rename(`Opinion on the Police` = views_police) %>%
  kbl(., booktabs = TRUE,  linesep = "",
      caption = "Opinion on the Police") %>%
  row_spec(0, bold = TRUE) %>%
  kable_styling(latex_options = "hold_position")
```
\normalsize

## Opinion on the Judicial System

Lastly, we asked how respondents evaluate their local judiciary. As in the
previous question, subjects could choose among five options, as well as affirm
that they do not have an opinion or decline to answer the question.

\footnotesize
```{r justice, warning=F, error=F, cache=T}
df1 %>%
  group_by(views_justice) %>%
  filter(!is.na(views_justice)) %>%
  summarise(N = n()) %>%
  mutate(Frequency = round(N / sum(N), 3)) %>%
  rename(`Opinion on the Judicial System` = views_justice) %>%
  kbl(., booktabs = TRUE,  linesep = "",
      caption = "Opinion on the Judicial System") %>%
  row_spec(0, bold = TRUE) %>%
  kable_styling(latex_options = "hold_position")
```
\normalsize

# Experiment 01

## Description 

In our first experiments, we present five pairs of criminal profiles to
respondents. Each profile consists of eight attributes: 1) gender of the crime
perpetrator; 2) age of the crime perpetrator; 3) race of the crime perpetrator;
4) residency of crime perpetrator; 5) offense; 6) gender of the victim of the
motivating crime; 7) age of the victim of the motivating crime; 8) lynching
perpetrators. The attributes and levels are displayed in table
\ref{tab:categories} below. 

\vspace{.3cm}

\begin{table}[htpb]
\small
\begin{center}
\caption{\textbf{Attributes and Levels}}
\label{tab:categories}
\begin{tabular}{l !{\vrule width 1pt}p{9cm}}
\Xhline{2\arrayrulewidth}
\textbf{Attribute} & \multicolumn{1}{c}{\textbf{Levels}} \\
\Xhline{2\arrayrulewidth}
\small
Gender of crime perpetrator & Male; female \\ [4pt]
Age of crime perpetrator & Teenager; adult; elderly \\ [4pt]
Race of crime perpetrator & Black; White; Native Brazilian; Asian \\ [4pt]
Residency of crime perpetrator & Resident in the community; outsider \\ [4pt]
Offense & Picks the pocket; steals the car; molests; rapes; murders \\ [4pt]
Gender of crime victim & Male; female\\ [4pt]
Age of crime victim & Child; teenager; adult; elderly\\ [4pt]
Lynching perpetrators & Bystanders; neighbours; family of the victim; gangs; police \\
\Xhline{2\arrayrulewidth}
\end{tabular}
\end{center}
\end{table}

Respondents indicated which profile they preferred for extrajudicial
punishment. They had read the following prompt prior to the experiment:

* `Lynchings are often used as social punishment in Brazil. Lynchings are cases
  in which three or more people physically attack or execute a suspected
  criminal in public. We are interested in knowing more about how Brazilians
  see these episodes. In the next five questions, please read the description
  of two possible lynching victims in Brazil and indicate in which case you
  believe the punishment is more justified. Even if you are not entirely sure,
  please select one of the cases.`[^portuguese]

[^portuguese]: Original text in Portuguese: `Linchamentos são às vezes usados
como punição social no Brasil. Linchamentos são casos nos quais três ou mais
pessoas agridem fisicamente ou executam em público um suspeito de um crime.
Estamos interessados em saber mais sobre como os brasileiros vêem estes
episódios. Nas próximas cinco questões, por favor, leia a descrição de duas
possíveis vítimas de linchamento no Brasil e indique em quais delas você
acredita que a punição é mais justificada. Mesmo que você não tenha certeza,
por favor, escolha um dos casos.`

## Replication Code

We estimate the conjoint experiments with the `cregg` package
[@leeper2018cregg] for the `R` statistical language [@rstats2019]. We follow
@leeper2018subgroup and report marginal means 

We will cluster standard errors by
respondent. The code follows below.

\footnotesize
```{r conjointfull, warning=F, error=F, cache=T, fig.width=7, fig.height=6}
conjoint_data <- read.qualtrics("../data/data-conjoint.csv",
                                responses = c("Q13", "Q14", "Q15",
                                              "Q16", "Q17"),
                                covariates = c("ResponseId",
                                               "Q1", "Q2", "Q3", "Q4",
                                               "Q5", "Q6", "Q7",
                                               "Q8", "Q9", "Q10",
                                               "Q11", "Q12"),
                                new.format = FALSE, respondentID = NULL)

conjoint_data <- conjoint_data %>%
  rename(response_id                      = ResponseId,
         Age                              = Q2,
         Gender                           = Q3,
         Race                             = Q4,
         Education                        = Q5,
         Region                           = Q6,
         "Household Income"               = Q7,
         Ideology                         = Q8,
         "Support death penalty"          = Q9,
         "Previous Victimization"         = Q10,
         "Offense"                        = Crime,
         "Opinion on Policing"            = Q11,
         "Opinion on Judiciary"           = Q12,
         "Gender of crime victim"         = "Gênero.da.vítima",
         "Gender of crime perpetrator"    = "Gênero.do(a).criminoso(a)",
         "Age of crime victim"            = "Idade.da.vítima",
         "Age of crime perpetrator"       = "Idade.do(a).criminoso(a)",
         "Lynching perpetrators"          = "Linchadores",
         "Race of crime perpetrator"      = "Raça.do(a).criminoso(a)",
         "Residency of crime perpetrator" = "Residência.do.criminoso") %>%
  mutate(`Gender of crime perpetrator` = fct_recode(`Gender of crime perpetrator`,
                                                    "Male"   = "Masculino",
                                                    "Female" = "Feminino"),
         `Age of crime perpetrator` = fct_recode(`Age of crime perpetrator`,
                                                 "Teenager" = "Adolescente",
                                                 "Adult"    = "Adulto(a)",
                                                 "Elderly"  = "Idoso(a)"),
         `Race of crime perpetrator` = fct_recode(`Race of crime perpetrator`,
                                                  "Asian"      = "Asiático(a)",
                                                  "White"      = "Branco(a)",
                                                  "Indigenous" = "Indígena",
                                                  "Black"      = "Negro(a)"),
         `Residency of crime perpetrator` = fct_recode(`Residency of crime perpetrator`,
                                                       "Another neighborhood" = "Mora em outro bairro",
                                                       "In the neighborhood"  = "Mora na vizinhança"),
         `Offense` = fct_recode(`Offense`,
                                "Murder"         = "Assassinou",
                                "Pick-pocketing" = "Bateu a carteira",
                                "Rape"           = "Estuprou",
                                "Molestation"    = "Molestou",
                                "Car theft"      = "Roubou o carro"),
         `Gender of crime victim` = fct_recode(`Gender of crime victim`,
                                               " Male"   = "Masculino",
                                               " Female" = "Feminino"),
         `Age of crime victim` = fct_recode(`Age of crime victim`,
                                            " Teenager" = "Adolescente",
                                            " Child"    = "Criança",
                                            " Adult"    = "Adulto(a)",
                                            " Elderly"  = "Idoso(a)"),
         `Lynching perpetrators` = fct_recode(`Lynching perpetrators`,
                                              "Family of the victim" = "Família da vítima",
                                              "Gangs" = "Gangues",
                                              "Bystanders" = "Pedestres",
                                              "Police" = "Polícia",
                                              "Neighbors" = "Vizinhos")) %>%
  select(-c(16, 18, 20, 22, 24, 26, 28, 30)) %>%
  mutate(response_id = tolower(response_id))

fm <- selected ~ `Gender of crime perpetrator` +
  `Age of crime perpetrator` + `Race of crime perpetrator` +
  `Residency of crime perpetrator` + `Offense` +
  `Gender of crime victim` + `Age of crime victim` +
  `Lynching perpetrators`

faces <- c(rep("plain", 5), "bold",
           rep("plain", 4), "bold",
           rep("plain", 2), "bold",
           rep("plain", 5), "bold",
           rep("plain", 2), "bold",
           rep("plain", 4), "bold",
           rep("plain", 3), "bold",
           rep("plain", 2), "bold")

plot(mm(conjoint_data, fm, id = ~response_id),
     vline = 0.5, header_fmt = "%s") +
  theme(legend.position = "none",
        axis.text.y = element_text(face = faces, size = 10)) +
  scale_colour_viridis_d(option = "inferno", end = 0.8)
```
\normalsize










\newpage

# Session Information
\label{sec:session-info}

```{r session, cache=TRUE}
sessionInfo()
```

# References
